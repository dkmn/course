<?php

/**
 * Master class for Course tests.
 */
class CourseTestCase extends DrupalWebTestCase {

  public function setUp() {
    parent::setUp('autoload', 'ahah_helper', 'ctools', 'uuid', 'course', 'course_test');

    $this->admin_user = $this->drupalCreateUser(array('administer nodes', 'edit courses'));
    $this->student_user = $this->drupalCreateUser(array('access content'));
    $this->drupalLogin($this->admin_user);

    // Flush handlers (because we created this one on the fly).
    course_get_handlers(NULL, TRUE);

    // Flush autoload. Fixes some issues with late declaration of classes.
    autoload_flush_caches();
  }

  /**
   * Create a course node using the test content type.
   *
   * @return stdClass
   */
  function createCourseNode() {
    $node = $this->drupalCreateNode(array(
      'type' => 'course_test',
      ));

    return $node;
  }

  /**
   * Create a new persistent course object on a Course.
   *
   * @param stdClass $courseNode
   * @return Course
   */
  function createCourseObject($courseNode) {
    $courseObject = course_get_course_object('course_test', 'course_test_object');
    $courseObject->setCourse($courseNode->nid);
    $courseObject->save();
    return $courseObject;
  }

}
